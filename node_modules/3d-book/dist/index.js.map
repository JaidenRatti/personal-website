{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["import React, { useEffect, useRef } from 'react'\nimport * as THREE from 'three'\n\nconst Book = (props) => {\n  const mountRef = useRef(null)\n\n  useEffect(() => {\n    const { bookCovers, style } = props\n    const aspect = style.width / style.height\n\n    const getBookMaterials = (urlMap) => {\n      const materialNames = ['edge', 'spine', 'top', 'bottom', 'front', 'back']\n      return materialNames.map((name) => {\n        if (!urlMap[name]) return new THREE.MeshBasicMaterial(0xffffff)\n\n        const texture = new THREE.TextureLoader().load(urlMap[name])\n\n        // to create high quality texture\n        texture.generateMipmaps = false\n        texture.minFilter = THREE.LinearFilter\n        texture.needsUpdate = true\n\n        return new THREE.MeshBasicMaterial({ map: texture })\n      })\n    }\n\n    const refCurrent = mountRef.current\n    const scene = new THREE.Scene()\n    scene.background = new THREE.Color(style.background)\n\n    const planeGeometry = new THREE.PlaneGeometry(500, 500, 32, 32)\n    const planeMaterial = new THREE.ShadowMaterial()\n    planeMaterial.opacity = 0.5\n\n    const plane = new THREE.Mesh(planeGeometry, planeMaterial)\n    plane.receiveShadow = true\n    scene.add(plane)\n\n    const light = new THREE.DirectionalLight(0xffffff, 1)\n    light.position.set(-10, 10, 10)\n    light.castShadow = true\n    scene.add(light)\n\n    const geometry = new THREE.BoxGeometry(3.5, 5, 0.5)\n    const cube = new THREE.Mesh(geometry, getBookMaterials(bookCovers))\n    cube.castShadow = true\n    cube.position.set(0, 0, 0)\n    scene.add(cube)\n\n    // const helper = new THREE.CameraHelper(light.shadow.camera);\n    // scene.add(helper);\n\n    let isMouseOver = false\n    refCurrent.addEventListener('mouseover', () => {\n      isMouseOver = true\n    })\n    refCurrent.addEventListener('mouseleave', () => {\n      isMouseOver = false\n    })\n\n    let degrees = 90\n\n    const camera = new THREE.PerspectiveCamera(70, aspect, 1, 1000)\n    camera.position.set(0, 0, 6)\n\n    const renderer = new THREE.WebGLRenderer()\n    renderer.shadowMap.enabled = true\n    renderer.shadowMap.type = THREE.PCFSoftShadowMap\n    renderer.setSize(style.width, style.height)\n\n    const distance = camera.position.distanceTo(cube.position)\n\n    const rotate = () => {\n      if (degrees < 135) {\n        degrees += 2\n        const radian = degrees * (Math.PI / 180)\n        camera.position.x = Math.cos(radian) * distance\n        camera.position.z = Math.sin(radian) * distance\n      }\n    }\n\n    const rotateBack = () => {\n      if (degrees > 90) {\n        degrees -= 2\n        const radian = degrees * (Math.PI / 180)\n        camera.position.x = Math.cos(radian) * distance\n        camera.position.z = Math.sin(radian) * distance\n      }\n    }\n\n    const animate = () => {\n      requestAnimationFrame(animate)\n      isMouseOver ? rotate() : rotateBack()\n      camera.lookAt(scene.position)\n      renderer.render(scene, camera)\n    }\n\n    refCurrent.appendChild(renderer.domElement)\n    animate()\n\n    return () => {\n      refCurrent.removeChild(renderer.domElement)\n    }\n  }, [props])\n\n  return <div ref={mountRef} style={props.style} />\n}\nexport default Book\n"],"names":["Book","props","mountRef","useRef","useEffect","bookCovers","style","aspect","width","height","getBookMaterials","urlMap","materialNames","map","name","THREE","texture","load","generateMipmaps","minFilter","needsUpdate","refCurrent","current","scene","background","planeGeometry","planeMaterial","opacity","plane","receiveShadow","add","light","position","set","castShadow","geometry","cube","isMouseOver","addEventListener","degrees","camera","renderer","shadowMap","enabled","type","setSize","distance","distanceTo","rotate","radian","Math","PI","x","cos","z","sin","rotateBack","animate","requestAnimationFrame","lookAt","render","appendChild","domElement","removeChild","React"],"mappings":"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"}